<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>KO POC</title>
    <!--<script src="Scripts/require.js" data-main="Scripts/bootstrapper"></script>-->
    <script src="Scripts/knockout-3.3.0.js"></script>
</head>
<body>

    <select data-bind="options: firstNames, 
            optionsCaption: '---',
            value: firstNameFilter"></select>

    <div style="border: 1px solid black;" data-bind="foreach: filteredPersons">
        <p>
            <span data-bind="text: firstName"></span>
            <span data-bind="text: lastName"></span>
            <span data-bind="text: gender"></span>
        </p>
    </div>

    <script type="text/javascript">

        function Person(firstName, LastName, gender) {
            this.firstName = ko.observable(firstName);
            this.lastName = ko.observable(LastName);
            this.gender = ko.observable(gender);
        }

        function ViewModel() {
            var self = this;
            self.persons = ko.observableArray([
                new Person('John', 'Lennon', 'Male'),
                new Person('John', 'Torn', 'Male'),
                new Person('Tanya', 'Dmitrieva', 'Female'),
                new Person('George', 'Tupak', 'Male'),
                new Person('George', 'Mama', 'Male')
            ]);

            self.filteredPersons = ko.pureComputed(function () {
                return ko.utils.arrayFilter(self.persons(), function (person) {
                    return !(person.firstName() === self.firstNameFilter());
                });
            });

            self.firstNames = ko.pureComputed(function () {
                return ko.utils.arrayGetDistinctValues(ko.utils.arrayMap(self.persons(), function (person) {
                    return person.firstName();
                }));
            });
            
            self.firstNameFilter = ko.observable();

        }

        ko.applyBindings(new ViewModel());
        
    </script>

</body>
</html>